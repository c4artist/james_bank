# Can you help me make this work.  I think it is a 90% solution.
# I used comments to tell what i am trying to do as well as ask questions.
# Please let me know if you have any questions.
# In simplest terms, I want a buy and sell order for a stock always pending unless sell order is
#       processed.. then just one last buy order is placed.  I will run algorithm again from beginning
#       after that purchase has settled.

# I sell when cost basis is 10% above current share price.
# I buy more if cost basis is 10% below current share price.

# I have my alpaca keys in a config file as you can see below by the imports
# what else do i need to import to make this program work?

import config
ALPACA_API_KEY = config.API_KEY
ALPACA_SECRET_KEY = config.SECRET_KEY

import alpaca_trade_api as tradeapi
api = tradeapi.REST()


stock_symbol = input("Enter stock symbol")
dollar_limit = 6500.00
stock_symbol_cost_basis = PULL FROM ALPACA      #HOW DO I DO THIS?
stock_symbol_current_share_balance = PULL FROM ALPACA       #HOW DO I DO THIS?
stock_symbol_cost_basis_per_share = stock_symbol_cost_basis / stock_symbol_current_current_share_balance
cash_available_for_buys = PULL FROM ALPACA      #HOW DO I DO THIS?

# place sell order for (stock_symbol_current_share_balance) for [1.1 * (stock_symbol_share_cost_basis)] as LIMIT ORDER
api.submit_order(
    symbol= stock_symbol,
    qty= stock_symbol_current_share_balance,
    side='sell',
    type='limit',
    time_in_force_='gtc'
    limit_price= (stock_symbol_cost_basis_per_share * 1.1),
    client_order_id= 'my_sell_order'
)

#place buy order for [2 * (stock_symbol_current_share_balance)] for [.9 * (stock_symbol_share_cost_basis)] as LIMIT ORDER
api.submit_order(
    symbol= stock_symbol,
    qty= stock_symbol_current_share_balance * 2,
    side='buy',
    type='limit',
    time_in_force_='gtc',
    limit_price= stock_symbol_cost_basis_per_share * .9,
    client_order_id= 'my_buy_order'
)

#if sell order is processed    HOW DO I CONFIRM IS SELL ORDER WAS FILLED??
#cancel pending buy order
    api.cancel.all_orders()
#place new buy order for 1 share of (stock_symbol) as MARKET ORDER
    api.submit_order(
    symbol= stock_symbol,
    qty= 1,
    side='buy',
    type='market',
    time_in_force_='gtc',
    return (STOP PROGRAM)

#elif buy order is processed AND (cash_available_for_buys) >= (dollar_limit)
    api.cancel.all_orders()

#!! HOW DO I UPDATE VARISBLES HERE
#place sell order for (stock_symbol_current_share_balance) for [1.1 * (share_cost_basis)] as LIMIT ORDER
    api.submit_order(
        symbol= stock_symbol,
        qty= stock_symbol_current_share_balance,
        side='sell',
        type='limit',
        time_in_force_='gtc'
        limit_price= stock_symbol_cost_basis_per_share * 1.1,
        client_order_id= 'my_sell_order'
)

#place buy order for [2 * (stock_symbol_current_share_balance)] for [.9 * (stock_symbol_current_share_cost_basis)] as LIMIT ORDER
    api.submit_order(
        symbol= stock_symbol,
        qty= stock_symbol_current_share_balance * 2,
        side='buy',
        type='limit',
        time_in_force_='gtc',
        limit_price= stock_symbol_cost_basis_per_share * .9,
        client_order_id= 'my_buy_order'
)
#otherwise
#STOP PROGRAM
        return